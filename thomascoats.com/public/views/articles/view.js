// Generated by CoffeeScript 1.6.3
(function() {
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  define(['q', 'knockout', 'articles/client', 'plugins/router'], function(Q, ko, ArticleLogic, router) {
    var ViewArticle;
    return ViewArticle = (function() {
      function ViewArticle() {
        this.deleteArticle = __bind(this.deleteArticle, this);
        this.activate = __bind(this.activate, this);
        this.canActivate = __bind(this.canActivate, this);
        this.article = ko.observable(null);
        this.articleLogic = new ArticleLogic();
      }

      ViewArticle.prototype.canActivate = function(id, name) {
        var dfd;
        dfd = Q.defer();
        this.articleLogic.getArticleForDisplay(id).then(function() {
          return dfd.resolve(true);
        }).fail(function(err) {
          return dfd.resolve(false);
        });
        return dfd.promise;
      };

      ViewArticle.prototype.activate = function(id, name) {
        var dfd,
          _this = this;
        dfd = Q.defer();
        return this.articleLogic.getArticleForDisplay(id).then(function(article) {
          _this.article({
            id: ko.observable(article.id),
            name: ko.observable(article.name),
            url: ko.observable(article.url)
          });
          return dfd.resolve(true);
        }).fail(function() {
          return dfd.resolve(false);
        });
      };

      ViewArticle.prototype.deleteArticle = function() {
        var _this = this;
        return this.articleLogic.deleteArticle(this.article().id()).then(function() {
          return router.navigate('');
        });
      };

      return ViewArticle;

    })();
  });

}).call(this);
