// Generated by IcedCoffeeScript 1.6.3-g
(function() {
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };



  define(['knockout', 'jquery', 'articles/client', 'plugins/router'], function(ko, $, ArticleLogic, router) {
    var ViewArticle;
    return ViewArticle = (function() {
      function ViewArticle() {
        this.deleteArticle = __bind(this.deleteArticle, this);
        this.activate = __bind(this.activate, this);
        this.canActivate = __bind(this.canActivate, this);
        this.article = ko.observable(null);
        this.articleLogic = new ArticleLogic();
      }

      ViewArticle.prototype.canActivate = function(id, name) {
        var _this = this;
        return $.Deferred(function(deferred) {
          return _this.articleLogic.getArticleForDisplay(id).then(function() {
            return deferred.resolve(true);
          }).fail(function() {
            return deferred.resolve(false);
          });
        }).promise();
      };

      ViewArticle.prototype.activate = function(id, name) {
        var _this = this;
        return $.Deferred(function(deferred) {
          return _this.articleLogic.getArticleForDisplay(id).then(function(article) {
            _this.article({
              id: ko.observable(article.id),
              name: ko.observable(article.name),
              url: ko.observable(article.url)
            });
            return deferred.resolve(true);
          }).fail(function() {
            return deferred.resolve(false);
          });
        }).promise();
      };

      ViewArticle.prototype.deleteArticle = function() {
        var _this = this;
        return this.articleLogic.deleteArticle(this.article().id()).then(function() {
          return router.navigate('');
        });
      };

      return ViewArticle;

    })();
  });

}).call(this);
